# Story 1.13: Deprecate HeavyDB Code

## Status
To Do

## Story
**As a** System Administrator,
**I want** to completely remove all HeavyDB dependencies and code from the codebase,
**so that** we eliminate technical debt and reduce maintenance burden after the Parquet/Arrow/cuDF migration

## Acceptance Criteria
1. Remove all HeavyDB connector code from `/backend/lib/heavydb_connector/`
2. Delete deprecated workflow file `/backend/csv_only_heavydb_workflow.py`
3. Remove HeavyDB configuration files and references from `/config/`
4. Update all import statements and dependencies to remove HeavyDB references
5. Ensure no regression: all tests pass after HeavyDB removal
6. Document removed components for historical reference

## Tasks / Subtasks

### Task 1: Inventory HeavyDB Dependencies (AC: 1, 2, 3)
- [ ] Subtask 1.1: Scan codebase for HeavyDB imports
  - [ ] Use grep to find all `heavydb`, `pymapd`, and `HeavyDB` references
  - [ ] Create comprehensive list of files to modify or remove
  - [ ] Identify any hidden dependencies in configuration files
  - [ ] Document all HeavyDB-specific features for migration validation
- [ ] Subtask 1.2: Analyze code dependencies
  - [ ] Map which components depend on HeavyDB classes
  - [ ] Identify replacement components in Parquet/Arrow/cuDF
  - [ ] Check for any HeavyDB-specific optimizations
  - [ ] Create dependency graph for safe removal

### Task 2: Remove HeavyDB Core Components (AC: 1, 2)
- [ ] Subtask 2.1: Delete HeavyDB connector module
  - [ ] Remove `/backend/lib/heavydb_connector/` directory
  - [ ] Delete `connection_manager.py`, `heavydb_connection.py`
  - [ ] Remove any HeavyDB utility functions
  - [ ] Archive code for historical reference before deletion
- [ ] Subtask 2.2: Remove HeavyDB workflows
  - [ ] Delete `/backend/csv_only_heavydb_workflow.py`
  - [ ] Remove backup files `csv_only_heavydb_workflow_backup.py`
  - [ ] Delete any HeavyDB-specific test files
  - [ ] Update workflow documentation

### Task 3: Update Configuration and References (AC: 3, 4)
- [ ] Subtask 3.1: Clean configuration files
  - [ ] Remove `[HEAVYDB]` sections from all .ini files
  - [ ] Delete `heavydb_optimization.ini` if exists
  - [ ] Update `production_config.ini` to remove HeavyDB settings
  - [ ] Remove HeavyDB connection strings and credentials
- [ ] Subtask 3.2: Update import statements
  - [ ] Replace HeavyDB imports with Parquet/Arrow/cuDF equivalents
  - [ ] Update any conditional imports checking for HeavyDB
  - [ ] Fix any broken references after removal
  - [ ] Update __init__.py files to remove HeavyDB exports

### Task 4: Validate Clean Removal (AC: 5, 6)
- [ ] Subtask 4.1: Run comprehensive tests
  - [ ] Execute all unit tests to ensure no regression
  - [ ] Run integration tests with production data
  - [ ] Verify all 8 algorithms still function correctly
  - [ ] Test ULTA and zone optimizer functionality
- [ ] Subtask 4.2: Documentation and archival
  - [ ] Create `HEAVYDB_DEPRECATION.md` documenting what was removed
  - [ ] Archive critical HeavyDB code to `/docs/archive/heavydb/`
  - [ ] Update README to reflect new architecture
  - [ ] Add migration notes to CLAUDE.md

## Dev Notes

### Previous Story Context
This cleanup story follows the completion of retrofit stories 1.1R, 1.2R, and 1.4R, which migrate all functionality to Parquet/Arrow/cuDF. Only after those are complete can we safely remove HeavyDB.

### Files to Remove
```
/backend/lib/heavydb_connector/
├── __init__.py
├── connection_manager.py
├── heavydb_connection.py
└── heavydb_simulator.py

/backend/csv_only_heavydb_workflow.py
/backend/csv_only_heavydb_workflow_backup.py
/backend/csv_only_heavydb_workflow_real.py
```

### Configuration Cleanup
```ini
# Remove from production_config.ini:
[HEAVYDB]
host = localhost
port = 6274
database = optimizer_db
...
```

### Dependencies
- **Prerequisite**: Stories 1.1R, 1.2R, 1.4R must be complete
- **Blocks**: None - this is cleanup work
- **Risk**: Ensure production is fully migrated before execution

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-03 | 1.0 | Initial story creation for HeavyDB deprecation | Claude Code |

## Dev Agent Record

### Agent Model Used
[To be filled by Dev Agent]

### Debug Log References
[To be updated during implementation]

### Completion Notes List
[To be updated during implementation]

### File List
[To be updated during implementation]

## QA Results

### QA Review Summary
[To be completed by QA Agent after implementation]

### Acceptance Criteria Verification
[To be completed by QA Agent]

### Test Results
[To be completed by QA Agent]

### Code Quality Assessment
[To be completed by QA Agent]

### Issues Found
[To be completed by QA Agent]

### Compliance Check
[To be completed by QA Agent]

### Final QA Verdict
[To be completed by QA Agent]